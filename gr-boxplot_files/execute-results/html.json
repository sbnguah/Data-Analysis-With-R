{
  "hash": "2b931be6bafd0f0c7327b0d4f3da8968",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Boxplot\"\n---\n\n\n\n\nFirst we read in the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(list = ls(all = TRUE))\ndat <- \n    foreign::read.dta(\"C:/Dataset/bea_organ_damage_28122013.dta\")\ndataF <- \n    readstata13::read.dta13(\"C:/Dataset/olivia_data_wide.dta\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in readstata13::read.dta13(\"C:/Dataset/olivia_data_wide.dta\"): \n   Factor codes of type double or float detected in variables\n\n   anemia1, anemia2, anemia3, anemia4, anemia5\n\n   No labels have been assigned.\n   Set option 'nonint.factors = TRUE' to assign labels anyway.\n```\n\n\n:::\n:::\n\n\n# Boxplot\n\nNext we select three variables for plotting, keep only the complete cases and then store the\n`ggplot()` into an object called *BP*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBP <- \n  dat %>% \n  select(q12weight, q2idtype, q3sex) %>% \n  na.omit() %>%\n  ggplot(aes(x = q2idtype, y = q12weight, fill = q3sex))\n```\n:::\n\n\nNext we draw our boxplot with axis labels, title, axes format, and color specification.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBP + \n  geom_boxplot() +\n\ttheme_test() +\n\tlabs(title=\"My Boxplot\", x=\"Case or Control\", y=\"Weight (hgs)\") + \n\ttheme(plot.title = element_text(size=15, face=\"bold\"), \n\t      axis.text.x = element_text(size=12), \n\t      axis.text.y = element_text(size=12),\n\t      axis.title.x = element_text(size=13),\n\t      axis.title.y = element_text(size=13)) + \n  scale_color_discrete(name = \"Sex\")\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nNewt we set up a similar boxplot but this time use the *color* option for the `ggplot()` and not the\n*fill* option.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBP <- \n  dat %>% \n  select(q12weight, q2idtype, q3sex) %>% \n  na.omit() %>%\n  ggplot(aes(x = q2idtype, y = q12weight, color = q3sex))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nBP + \n  geom_boxplot() +\n\ttheme_light() +\n\tlabs(title = \"My Boxplot\", \n\t     x = \"Case or Control\", \n\t     y = \"Weight (hgs)\") + \n\ttheme(plot.title=element_text(size=15, face=\"bold\"), \n\t      axis.text.x=element_text(size=12), \n\t      axis.text.y=element_text(size=12),\n\t      axis.title.x=element_text(size=13),\n\t      axis.title.y=element_text(size=13)) + \n  scale_color_discrete(name=\"Sex\")\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nrm(BP, dat)\n```\n:::\n\n\nHere we use a different dataset to draw the next boxplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 <- read.csv(\"C:/Dataset/booking1.csv\")\nglimpse(df1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 50\nColumns: 4\n$ id     <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, …\n$ sex    <chr> \"Male\", \"Male\", \"Female\", \"Male\", \"Male\", \"Female\", \"Female\", \"…\n$ weight <int> 4, 10, 8, 14, 16, 9, 23, 14, 7, 13, 16, 10, 7, 13, 13, 10, 17, …\n$ height <int> 68, 81, 78, 90, 106, 85, 120, 98, 69, 88, 89, 81, 79, 93, 109, …\n```\n\n\n:::\n:::\n\n\nNext we plot two boxplots on one graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 %>% \n  na.omit() %>% \n  ggplot(aes(x = sex)) + \n\tgeom_boxplot(aes(y = weight, color=\"red\")) + \n\tgeom_boxplot(aes(y = height, color = \"steelblue\")) + \n  labs(color = \"Anthropometrics\") +\n  scale_color_manual(labels = c(\"Weight\",\"Height\"),\n                     values = c(\"red\", \"steelblue\"))\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nrm(df1)\n```\n:::\n\n\nWe then use the ToothGrowth data for for the next few boxplots\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(ToothGrowth)\nToothGrowth <-\n  ToothGrowth %>% \n  mutate(dose = factor(dose))\nglimpse(ToothGrowth)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 60\nColumns: 3\n$ len  <dbl> 4.2, 11.5, 7.3, 5.8, 6.4, 10.0, 11.2, 11.2, 5.2, 7.0, 16.5, 16.5,…\n$ supp <fct> VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, V…\n$ dose <fct> 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1, 1, 1, 1, 1, …\n```\n\n\n:::\n:::\n\n\nAnd then we form the ggplot object\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- \n  ToothGrowth %>% \n  ggplot(aes(x = dose, y = len))\n```\n:::\n\n\nOther renditions of the boxplot is as shown below. First rotated one\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + geom_boxplot() + coord_flip()     # Axis rotated\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nNotched boxplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + geom_boxplot(notch=TRUE)\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nCustomizaton of the outlier\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + geom_boxplot(outlier.colour=\"red\", \n                 outlier.shape=8, \n                 outlier.size=4)\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nWe add a statistic to the plot here\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + geom_boxplot() + \n\tstat_summary(fun = mean, \n\t             geom = \"point\", \n\t             shape = 18, \n\t             size = 4, \n\t             col = \"red\")\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nAnd then limit the categories the x axis\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + \n  geom_boxplot() + \n  scale_x_discrete(limits=c(\"0.5\", \"2\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 20 rows containing missing values or values outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nNext a boxplot with a superimposed dotplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + \n  geom_boxplot() + \n  geom_dotplot(binaxis='y', \n               stackdir='center', \n               dotsize=0.5, \n               binwidth = 1,\n               col = \"red\",\n               fill = \"red\")\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nAnd a boxplot with superimposed jittered points\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + \n  geom_boxplot() +\n  geom_jitter(shape=16, position=position_jitter(0.2))\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\nrm(p)\n```\n:::\n\n\nNext we manually set out own color scale\n\n\n::: {.cell}\n\n```{.r .cell-code}\nP <- \n  ToothGrowth %>% \n  ggplot(aes(factor(dose), len, color=dose))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nP + \n\tgeom_boxplot() +\n  scale_color_manual(values=c(\"#999999\", \"#E69F00\", \"#56B4E9\"))\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nAnd use one of the color scales\n\n\n::: {.cell}\n\n```{.r .cell-code}\nP + \n\tgeom_boxplot() +\n  scale_color_brewer(palette=\"Dark2\") +\n  scale_fill_brewer(palette=\"Dark2\")\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nChange the legend position\n\n\n::: {.cell}\n\n```{.r .cell-code}\nP + \n  geom_boxplot() +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nAnd remove legend\n\n\n::: {.cell}\n\n```{.r .cell-code}\nP + \n  geom_boxplot() +\n  theme(legend.position=\"none\")\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\nChange the order of items in the legend\n\n\n::: {.cell}\n\n```{.r .cell-code}\nP + \n  geom_boxplot() +\n  scale_x_discrete(limits=c(\"2\", \"0.5\", \"1\"))\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\nBox plot with multiple groups: Change box plot colors by groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(ToothGrowth, aes(x=dose, y=len, fill=supp)) + \n\tgeom_boxplot()\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n\n```{.r .cell-code}\nrm(P)\n```\n:::\n\n\nChange the position of the boxes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nP <- \n  ggplot(ToothGrowth, aes(x=dose, y=len, fill=supp)) + \n\tgeom_boxplot(position=position_dodge(1))\nP\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nAnd then we add dots\n\n\n::: {.cell}\n\n```{.r .cell-code}\nP + geom_dotplot(binaxis='y', \n                 stackdir='center', \n                 position=position_dodge(1),\n                 binwidth = 1)\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\nCustomized\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataF %>% \n    select(mcv1, mcv2, mcv3, mcv4, mcv5, agecat, id) %>%\n    pivot_longer(cols = mcv1:mcv5, names_to = \"Time\", values_to = \"MCV\") %>% \n    ggplot(aes(x = Time, y = MCV, col = Time), fill = \"snow1\") +\n    geom_boxplot(\n        outlier.color = 'black', \n        outlier.shape = 23, \n        outlier.fill = \"steelblue2\", \n        outlier.size = 2) +\n    stat_summary(\n        aes(fill=Time), \n        fun.data = mean_se, \n        geom = \"pointrange\", \n        size=0.5, \n        shape =23, \n        color = \"black\", \n        show.legend = F) +\n    scale_color_manual(\n        name = \"Measure\", \n        values = c(\"red\", \"yellow\", \"green\", \"violet\", \"brown\"),\n        labels = c(\"First\",\"Second\", \"Third\", \"Fourth\", \"Fifth\")) +\n    scale_x_discrete(\n        labels =c(\n            \"mcv1\" = \"First MCV\", \n            \"mcv2\" = \"Second MCV\", \n            \"mcv3\" = \"Third MCV\", \n            \"mcv4\" = \"Fourth MCV\", \n            \"mcv5\" = \"Fifth MCV\")) +\n    labs(title = \"Distribution of MCVs over the review periods\") +\n    theme(\n        plot.title = element_text(\n            family = \"serif\", \n            face = \"bold.italic\", \n            size = 14, \n            colour = \"steelblue4\", \n            hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](gr-boxplot_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndataF %>% \n    select(mcv1, mcv2, mcv3, mcv4, mcv5, agecat, id) %>%\n    pivot_longer(cols = mcv1:mcv5, names_to = \"Time\", values_to = \"MCV\") %>% \n    ggplot(aes(x = Time, y = MCV, col = Time), fill = \"snow1\") +\n    geom_boxplot(outlier.color = \"white\", outlier.alpha = 0) +\n    geom_jitter(width =.2, alpha = .2, col=1) +\n    labs(\n        x = \"Time of Sample taking\", \n        y = \"Mean Corpuscular Volume\",\n        title = \"Sequential changes in MCV over the study duration\") +\n    theme_bw() +\n    scale_x_discrete(\n        labels = c(\n            \"mcv1\" = \"First MCV\", \n            \"mcv2\" = \"Second MCV\", \n            \"mcv3\" = \"Third MCV\",\n            \"mcv4\" = \"Fourth MCV\",\n            \"mcv5\" = \"Fifth MCV\"))\n```\n\n::: {.cell-output-display}\n![Sequential changes in MCV over the study duration](gr-boxplot_files/figure-html/fig-five-1.png){#fig-five width=672}\n:::\n:::\n",
    "supporting": [
      "gr-boxplot_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}